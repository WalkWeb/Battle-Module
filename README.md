## Модуль командного боя

Написан на принципах DDD:

- Модуль имеет свой, независимый неймспейс `Battle`
- Модуль написан полностью независимым от фреймворков, и прочего
- Модуль изолированно выполняет свою задачу: принимает данные по сражающимся юнитам (это может быть как бой 1 на 1 так и
 команда на команду), обрабатывает бой и возвращает результат, на основании которого можно отобразить бой на фронте
- Классы в модуле полностью соответствуют «бизнес»-сущностям, а именно:
    - Бой обрабатывается в классе `Battle`
    - Сражающиеся две команды реализованы в классах `Command`
    - Команды состоят из юнитов (это могут быть как персонажи игроков, так и монстры), реализованных в классе `Unit`
    - Процесс боя проходит в раундах - классе `Round` в котором каждый живой юнит должен совершить свой ход. После того,
    как все юниты походили, начинается новый раунд
    - Раунд состоит из ходов одного юнита, и эти ходы реализованы в классах `Stroke`
    - Взаимодействие между юнитами построено на обмене абстрактных `Action` - это может быть как удар, так и лечение, 
    так и использование способности. При этом для внешних объектов совершенно не важно, что это - просто у одного юнита
    запрашивается коллекция его действий, и выполняется. При этом само действие определяет, на кого оно должно 
    примениться.
    - Результат бой сохраняется в `Result`
    - Статистика по бою сохраняется в `Statistic`
- Все важные зависимости завязаны на интерфейсы, а не на конкретную реализацию
- Большое внимание уделено тестам и проработке всех пограничных ситуаций. Покрытие кода тестами >99%

Пример боя:

`public/index.php`

Запуск тестов:

`php vendor/bin/phpunit`

## Пример

```php
use Battle\BattleFactory;
use Battle\View\ViewFactory;

$data = [
    [
        'id'           => '81941b8a-f7ca-447e-8951-36777ae6e79e',
        'name'         => 'Warrior',
        'level'        => 3,
        'avatar'       => '/images/avas/humans/human001.jpg',
        'damage'       => 25,
        'attack_speed' => 1.0,
        'life'         => 110,
        'total_life'   => 110,
        'melee'        => true,
        'class'        => 1,
        'command'      => 'left',
    ],
    [
        'id'           => 'bf75c4a3-b866-4787-88c7-8db57daf3d64',
        'name'         => 'Skeleton',
        'level'        => 2,
        'avatar'       => '/images/avas/monsters/005.png',
        'damage'       => 25,
        'attack_speed' => 1,
        'life'         => 65,
        'total_life'   => 65,
        'melee'        => true,
        'class'        => 3,
        'command'      => 'right',
    ],
];

$view = (new ViewFactory())->create();
echo $view->renderHead(); // example layout styles

$battle = BattleFactory::create($data);
$result = $battle->handle();
echo $view->renderResult($result);
```

## Как выглядит бой

![alt text](public/images/example_start.png)

### ...

![alt text](public/images/example_end.png)

## GitLab CI/CD

![alt text](public/images/gitlab-ci-cd.png)

## Планы

- Реализовать создание способности через массив параметров
- Подумать над реализацией ручного режима боя
- Задавать параметр action, concentration and rage у юнита через конструктор
- Убрать здоровье юнитов из сообщения в чате, но добавить цветовое выделение именам и способностям
- Добавить способностям иконки
- Добавить механику увеличения ярости
- В статистику добавить подсчет действий и атак сделанных юнитом (а когда будет добавлена меткость, блоки и криты - 
подсчет и их)
- Добавить расу юнитов (Раса как класс, которая возвращает id расы, название расы, иконку расы, цвет имени расы)
- Добавить особые способности рас: орки двойной урон на низком уровне здоровья, эльфы - способность уклониться от атак
люди - шанс избежать смерти и восстановить 50% здоровья
- Переделать отображение боя: стартовый вид юнитов, чат, детальный лог боя
- Реализовать анимацию боя на JS и генерацию скрипта для анимации
- Добавить больше разнообразных способностей
- Реализовать механику эффектов
- Расширить варианты классов, добавив новым классам новые варианты способностей
- Переделать простой int урон на объект Damage с расширенными параметрами, такие как шанс крита, сила крита, стихии 
урона и т.д.
- Реализовать расширенный вариант защитных параметров Defence - с такими параметрами как шанс блока, уклонение, 
сопротивления различным стихиям
- Сделать сайт-пример с боем
- Добавить ману
- В статистику добавить подсчет присумоненых существ
- Добавить параметр магического щита - когда часть урона идет по мане, перед здоровьем
- Сделать все аватары повернутыми вправо, а у правой команды через css разворачивать их по горизонтали, таким образом
все юниты будут смотреть друг на друга
- Добавить механику выбора победителя, когда остались живы обе команды - по количеству здоровья у выживших
- Добавить механику увеличения урона, в слишком долгих боях
- GitLab CI
- Docker
- Добавить параметр отвечающий за того, какой юнит ходит (или случайный)
- К параметру юнита, который ходит, добавить возможную цель для атаки и используемая способность
- Добавить конвертацию любой стадии боя в массив
- Перевести все комментарии в английский
- Добавить возможность отсутствия класса
- И многое другое
